<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The Stream Den</title>

    <!-- Open Graph (link preview) -->
    <meta property="og:title" content="The Stream Den ‚Äì Free Sports Streaming" />
    <meta property="og:description" content="Watch live sports with fewer ads." />
    <meta property="og:image" content="https://thestreamden.onrender.com/static/preview.png" />
    <meta property="og:url" content="https://thestreamden.onrender.com" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="The Stream Den ‚Äì Free Sports Streaming" />
    <meta name="twitter:description" content="Watch live sports with fewer ads." />
    <meta name="twitter:image" content="https://thestreamden.onrender.com/static/preview.png" />

    <!-- Modern font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    >

    <style>
        :root {
            --bg: #050508;
            --bg-alt: #050509;
            --text: #f5f5f5;
            --muted: #b8b8b8;
            --accent: #7aa2ff;
            --accent-soft: rgba(122, 162, 255, 0.16);         
            --border: #222;
            --surface-2: #12121a;
            --input-bg: #0f0f15;
            --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.65);
            --live: #ff4d6a;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background:
                radial-gradient(circle at top, #151521 0, #050508 45%, #000 100%);
            color: var(--text);
        }

        .page-wrapper {
            max-width: 1100px;
            margin: 0 auto;
            padding: 24px 20px 40px;
        }

        /* give room for fixed ad on big screens */
        @media (min-width: 1100px) {
            .page-wrapper { margin-right: 220px; }
        }

        /* === TOP NAV / BRAND BAR === */
        .top-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            color: var(--muted);
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            font-size: 0.82rem;
            color: #e5e9ff;
        }

        .brand-logo {
            width: 18px;
            height: 18px;
            border-radius: 6px;
            background: radial-gradient(circle at 30% 10%, #a1b5ff, #4f7cff 45%, #111321 100%);
            box-shadow: 0 0 0 1px rgba(122, 162, 255, 0.55);
        }

        .top-nav-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pill-label {
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            background: rgba(5, 5, 12, 0.85);
        }

        /* === DARK GLASS BLUE HEADER === */
        header {
            border-radius: 20px;
            padding: 18px 20px 14px;
            margin-bottom: 18px;
            background: radial-gradient(circle at top left, rgba(64, 117, 255, 0.38), rgba(5, 7, 18, 0.94));
            border: 1px solid rgba(122, 162, 255, 0.5);
            box-shadow: 0 22px 55px rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }

        /* header layout: title on left, ad on right */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .header-text { flex: 1 1 auto; }

        h1 {
            margin: 0 0 4px 0;
            font-size: 2.1rem;
            letter-spacing: 0.03em;
        }

        .header-subline {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            font-size: 0.85rem;
            color: var(--muted);
        }

        .tagline { margin: 0; color: var(--muted); }

        .live-counter-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.16);
            background: rgba(4, 6, 18, 0.9);
            font-size: 0.75rem;
        }

        .live-counter-pill::before {
            content: "";
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: var(--live);
            box-shadow: 0 0 8px rgba(255, 77, 106, 0.7);
        }

        .ad-slot-top-right {
            flex: 0 0 auto;
            text-align: right;
            max-width: 728px; /* 728x90 banner */
        }

        @media (max-width: 900px) {
            .header-container { flex-direction: column; align-items: flex-start; }
            .ad-slot-top-right { text-align: left; width: 100%; }
        }

        /* === Cross-promo banner === */
        .promo-strip {
            margin: 14px 0 14px 0;
            padding: 12px 14px;
            border-radius: 16px;
            background: radial-gradient(circle at top left, rgba(122, 162, 255, 0.22), rgba(5, 5, 18, 0.96));
            border: 1px solid rgba(122, 162, 255, 0.45);
            box-shadow: 0 14px 34px rgba(0, 0, 0, 0.75);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .promo-left { display: flex; flex-direction: column; gap: 3px; }
        .promo-title { font-size: 0.95rem; font-weight: 700; letter-spacing: 0.02em; color: #e8ecff; }
        .promo-subtitle { font-size: 0.82rem; color: var(--muted); }

        .promo-cta {
            flex: 0 0 auto;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 9px 14px;
            border-radius: 999px;
            border: 1px solid rgba(122, 162, 255, 0.65);
            background: rgba(122, 162, 255, 0.14);
            color: #eef2ff;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            transition: transform 0.12s ease, background 0.15s ease, border-color 0.15s ease;
        }

        .promo-cta:hover {
            transform: translateY(-1px);
            background: rgba(122, 162, 255, 0.22);
            border-color: rgba(122, 162, 255, 0.9);
        }

        .promo-cta .pill {
            font-size: 0.72rem;
            padding: 2px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.14);
            background: rgba(0, 0, 0, 0.18);
            color: #dbe4ff;
        }

        @media (max-width: 650px) {
            .promo-strip { flex-direction: column; align-items: flex-start; }
            .promo-cta { width: 100%; justify-content: center; }
        }

        /* search bar */
        .search-shell {
            margin: 18px 0 10px 0;
            position: sticky;
            top: 12px;
            z-index: 5;
        }

        @media (max-width: 900px) { .search-shell { position: static; } }

        .search-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            padding: 10px 12px;
            border-radius: 14px;
            background: rgba(5, 5, 12, 0.96);
            border: 1px solid rgba(255, 255, 255, 0.04);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.6);
        }

        .search-bar input[type="text"] {
            flex: 1 1 220px;
            padding: 9px 11px;
            font-size: 0.95rem;
            background: var(--input-bg);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 999px;
            outline: none;
            transition: border 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
        }

        .search-bar input[type="text"]::placeholder { color: #8a8a8a; }

        .search-bar input[type="text"]:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 1px rgba(122, 162, 255, 0.7);
            background: #11111b;
        }

        .search-actions { display: flex; flex-wrap: wrap; gap: 6px; }

        .search-bar button {
            padding: 8px 14px;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: var(--surface-2);
            color: var(--text);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: background 0.15s ease, transform 0.1s ease, border-color 0.15s ease;
        }

        .search-bar button:hover {
            background: #191925;
            border-color: rgba(122, 162, 255, 0.7);
            transform: translateY(-1px);
        }

        .search-bar button[type="button"].secondary-btn {
            background: transparent;
            color: var(--muted);
        }

        .search-bar button[type="button"].secondary-btn:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        /* live filter + segmented style */
        .live-filter-button {
            border-radius: 999px;
            border: 1px solid rgba(255, 77, 106, 0.6);
            background: rgba(255, 77, 106, 0.12);
            color: #ffdfe7;
        }

        .live-filter-button::before {
            content: "";
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: var(--live);
            box-shadow: 0 0 8px rgba(255, 77, 106, 0.7);
        }

        .live-filter-button.active {
            background: rgba(255, 77, 106, 0.25);
            border-color: rgba(255, 77, 106, 0.9);
            color: #ffeef2;
        }

        /* QUICK FILTER CHIPS */
        .quick-filters {
            margin: 6px 0 18px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            font-size: 0.8rem;
        }

        .quick-filters-label { color: var(--muted); margin-right: 4px; }

        .filter-chip {
            border-radius: 999px;
            padding: 5px 11px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            background: rgba(9, 9, 16, 0.9);
            color: var(--text);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease, color 0.15s ease;
        }

        .filter-chip span.emoji { font-size: 0.9rem; }

        .filter-chip:hover {
            background: rgba(20, 22, 40, 0.96);
            border-color: rgba(122, 162, 255, 0.7);
            transform: translateY(-1px);
        }

        .filter-chip.active {
            background: var(--accent-soft);
            border-color: rgba(122, 162, 255, 0.85);
            color: #e2e8ff;
        }

        /* === NOW PLAYING STRIP === */
        .now-playing {
            margin-bottom: 24px;
            padding: 12px 14px;
            border-radius: 16px;
            background: radial-gradient(circle at top left, rgba(64, 117, 255, 0.3), rgba(5, 5, 18, 0.96));
            border: 1px solid rgba(122, 162, 255, 0.5);
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
        }

        .now-playing-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            margin-bottom: 6px;
        }

        .now-playing-title {
            font-size: 0.95rem;
            font-weight: 600;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: #e0e7ff;
        }

        .now-playing-subtitle { font-size: 0.8rem; color: var(--muted); }

        .now-playing-list { display: flex; flex-wrap: wrap; gap: 8px; }

        .now-playing-item {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 999px;
            background: rgba(4, 7, 20, 0.9);
            border: 1px solid rgba(159, 180, 255, 0.5);
            color: #e2e7ff;
            font-size: 0.8rem;
            text-decoration: none;
            max-width: 100%;
            overflow: hidden;
        }

        .now-playing-item:hover {
            background: rgba(20, 28, 60, 0.95);
            transform: translateY(-1px);
            box-shadow: 0 14px 30px rgba(0, 0, 0, 0.7);
        }

        .now-playing-matchup {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 210px;
        }

        .now-playing-meta { font-size: 0.7rem; color: #c7cffc; opacity: 0.9; }

        /* SPORT SECTIONS */
        .sport-section {
            margin-bottom: 16px;
            border-radius: 14px;
            background: rgba(5, 5, 12, 0.92);
            border: 1px solid rgba(255, 255, 255, 0.04);
            overflow: hidden;
        }

        .sport-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            cursor: pointer;
            background: linear-gradient(135deg, rgba(48, 88, 210, 0.45), rgba(3, 5, 18, 0.95));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(122, 162, 255, 0.35);
        }

        .sport-header-left { display: flex; align-items: center; gap: 10px; }

        .sport-pill {
            width: 8px;
            height: 32px;
            border-radius: 999px;
            background: linear-gradient(to bottom, var(--accent), transparent);
            opacity: 0.9;
        }

        .sport-title-text { display: flex; flex-direction: column; }

        .sport-title-text h2 {
            margin: 0;
            font-size: 1rem;
            letter-spacing: 0.04em;
            text-transform: uppercase;
        }

        .sport-subtitle { font-size: 0.78rem; color: var(--muted); margin-top: 2px; }

        .sport-toggle-icon {
            font-size: 1rem;
            color: var(--muted);
            transition: transform 0.15s ease, color 0.15s ease;
        }

        .sport-section.open .sport-toggle-icon {
            transform: rotate(90deg);
            color: var(--accent);
        }

        .sport-section:hover .sport-header {
            background: linear-gradient(135deg, rgba(80, 130, 255, 0.5), rgba(5, 8, 24, 0.97));
        }

        .sport-body { padding: 8px 10px 12px; display: none; }
        .sport-section.open .sport-body { display: block; }

        /* GRID OF GAME CARDS */
        .sport-games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
            gap: 10px;
        }

        .game-card {
            border: 1px solid rgba(255, 255, 255, 0.04);
            background: radial-gradient(circle at top left, rgba(122, 162, 255, 0.09), var(--surface));
            padding: 12px 13px;
            border-radius: 14px;
            box-shadow: 0 10px 22px rgba(0, 0, 0, 0.6);
            transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.2s ease;
        }

        .game-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.85);
            border-color: rgba(122, 162, 255, 0.7);
            background: radial-gradient(circle at top left, rgba(122, 162, 255, 0.12), #0b0b12);
        }

        .game-title-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            margin-bottom: 6px;
        }

        .game-title { font-weight: 600; font-size: 1.02em; }
        .game-title a { color: #e5e9ff; text-decoration: none; }
        .game-title a:hover { color: #ffffff; text-shadow: 0 0 8px rgba(122, 162, 255, 0.4); }

        .game-tags-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .game-tags { display: flex; flex-wrap: wrap; gap: 6px; font-size: 0.72rem; }

        .tag-pill {
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: rgba(8, 8, 18, 0.9);
            color: #d7ddff;
            white-space: nowrap;
        }

        .tag-pill.outline { border-style: dashed; opacity: 0.85; }

        .game-time {
            font-size: 0.8rem;
            color: var(--muted);
            text-align: right;
            white-space: nowrap;
        }

        .meta { font-size: 0.82rem; color: var(--muted); margin-top: 4px; line-height: 1.45; }
        .meta strong { color: #d0d0d0; font-weight: 500; }

        .live-button {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(255, 77, 106, 0.9);
            background: rgba(255, 77, 106, 0.18);
            color: #ffeef2;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: default;
        }

        .live-button::before {
            content: "";
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: var(--live);
            box-shadow: 0 0 8px rgba(255, 77, 106, 0.8);
        }

        a {
            text-decoration: none;
            color: var(--accent);
            transition: color 0.15s ease, text-shadow 0.18s ease;
        }
        a:hover { color: #a4bcff; text-shadow: 0 0 8px rgba(122, 162, 255, 0.4); }

        .empty-state {
            margin-top: 40px;
            padding: 18px 16px;
            border-radius: 14px;
            background: rgba(10, 10, 16, 0.9);
            border: 1px dashed rgba(122, 162, 255, 0.4);
            color: var(--muted);
            text-align: center;
            font-size: 0.95rem;
        }

        /* Fixed right-side vertical ad (does NOT push content down) */
        .vertical-ad-fixed {
            position: fixed;
            top: 120px;
            right: 20px;
            width: 160px;
            height: 600px;
            z-index: 100;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 16px 36px rgba(0, 0, 0, 0.85);
        }

        @media (max-width: 1100px) { .vertical-ad-fixed { display: none; } }

        /* ===== MOST VIEWED FIXED LEFT SIDEBAR ===== */
        .vertical-most-viewed-fixed {
            position: fixed;
            top: 120px;
            left: 20px;
            width: 220px;
            z-index: 101;
        }

        .most-viewed-box {
            border-radius: 16px;
            padding: 10px 11px 12px;
            background: radial-gradient(circle at top left, rgba(64, 117, 255, 0.32), rgba(5, 5, 18, 0.98));
            border: 1px solid rgba(122, 162, 255, 0.6);
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.9);
            font-size: 0.82rem;
        }

        .most-viewed-header {
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.09em;
            text-transform: uppercase;
            margin-bottom: 6px;
            color: #e3e8ff;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .most-viewed-header span.badge {
            font-size: 0.7rem;
            padding: 2px 7px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            background: rgba(5, 8, 24, 0.9);
            color: var(--muted);
        }

        .most-viewed-list { display: flex; flex-direction: column; gap: 6px; }

        .mv-item {
            display: block;
            padding: 6px 7px;
            border-radius: 10px;
            background: rgba(4, 7, 20, 0.95);
            border: 1px solid rgba(159, 180, 255, 0.35);
            color: #e4e8ff;
            text-decoration: none;
            transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease;
        }

        .mv-item:hover {
            background: rgba(20, 28, 60, 0.97);
            border-color: rgba(159, 180, 255, 0.85);
            transform: translateY(-1px);
            box-shadow: 0 14px 30px rgba(0, 0, 0, 0.85);
        }

        .mv-title {
            font-size: 0.83rem;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 2px;
        }

        .mv-meta {
            font-size: 0.72rem;
            color: #c7cffc;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .mv-viewers { font-size: 0.72rem; color: #ffdfe7; }

        @media (max-width: 1400px) { .vertical-most-viewed-fixed { display: none; } }

        footer {
            margin-top: 20px;
            padding: 12px 20px 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            background: rgba(3, 3, 8, 0.9);
        }

        footer .footer-inner { max-width: 1100px; margin: 0 auto; }

        footer p { margin: 0 0 6px 0; font-size: 0.8rem; color: var(--muted); }

        .social-row {
            margin-top: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .social-link {
            font-size: 0.8rem;
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            background: rgba(8, 8, 16, 0.9);
            color: var(--text);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            text-decoration: none;
            transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease;
        }

        .social-link span.handle { color: var(--accent); }

        .social-link:hover {
            background: rgba(18, 18, 28, 0.95);
            border-color: rgba(122, 162, 255, 0.7);
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="page-wrapper">

        <!-- Small brand row above header -->
        <div class="top-nav">
            <div class="brand">
                <div class="brand-logo"></div>
                <span>The Stream Den</span>
            </div>
            <div class="top-nav-right">
                <div class="pill-label">live sports</div>
            </div>
        </div>

        <!-- Header with title on left, 728x90 ad on right -->
        <header>
            <div class="header-container">
                <div class="header-text">
                    <h1>Today's Games</h1>
                    <div class="header-subline">
                        <p class="tagline">Browse live and upcoming streams in one place.</p>
                        {% if sections %}
                            {% set total_live = 0 %}
                            {% for section in sections %}
                                {% set live_count = section.games|selectattr('is_live')|list|length %}
                                {% set total_live = total_live + live_count %}
                            {% endfor %}
                            {% if total_live > 0 %}
                                <span class="live-counter-pill">
                                    {{ total_live }} live game{% if total_live != 1 %}s{% endif %} right now
                                </span>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>

                <div class="ad-slot-top-right">
                    <!-- 728x90 banner (Adsterra / broodbelongminiature) -->
                    <script type="text/javascript">
                      atOptions = {
                      	'key' : '404cd50590d1227fb3038749119d5034',
                      	'format' : 'iframe',
                      	'height' : 90,
                      	'width' : 728,
                      	'params' : {}
                      };
                    </script>
                    <script
                      type="text/javascript"
                      src="https://broodbelongminiature.com/404cd50590d1227fb3038749119d5034/invoke.js"
                    ></script>
                </div>
            </div>
        </header>

        <!-- Promo for The Odds Den -->
        <div class="promo-strip">
            <div class="promo-left">
                <div class="promo-title">Want odds + parlay tools?</div>
                <div class="promo-subtitle">
                    Build parlays, compare lines, and see metrics on <strong>The Odds Den</strong>.
                </div>
            </div>

            <a class="promo-cta" href="https://theoddsden.onrender.com" target="_blank" rel="noopener">
                Open TheOddsDen <span class="pill">‚Üó</span>
            </a>
        </div>

        <!-- Search bar + quick filters -->
        <div class="search-shell">
            <form class="search-bar" method="get" action="{{ url_for('index') }}">
                <input
                    id="searchInput"
                    type="text"
                    name="q"
                    placeholder="Search by team, sport, or tournament..."
                    value="{{ search_query or '' }}"
                >
                <div class="search-actions">
                    <button type="submit">üîç Search</button>

                    <button
                        type="button"
                        class="live-filter-button {% if live_only %}active{% endif %}"
                        onclick="toggleLiveOnly({{ 'true' if live_only else 'false' }})">
                        üî¥ Live only
                    </button>

                    {% if search_query %}
                        <button
                            type="button"
                            class="secondary-btn"
                            onclick="window.location='{{ url_for('index') }}'">
                            ‚úñ Clear
                        </button>
                    {% endif %}
                </div>

                {% if live_only %}
                    <input type="hidden" name="live_only" value="1">
                {% endif %}
            </form>

            <div class="quick-filters">
                <span class="quick-filters-label">Quick filters:</span>
                <button class="filter-chip" type="button" onclick="applyFilterChip('NFL')"><span class="emoji">üèà</span> NFL</button>
                <button class="filter-chip" type="button" onclick="applyFilterChip('Basketball')"><span class="emoji">üèÄ</span> Basketball</button>
                <button class="filter-chip" type="button" onclick="applyFilterChip('ICE HOCKEY')"><span class="emoji">üèí</span> ICE HOCKEY</button>
                <button class="filter-chip" type="button" onclick="applyFilterChip('MLB')"><span class="emoji">‚öæ</span> MLB</button>
                <button class="filter-chip" type="button" onclick="applyFilterChip('Soccer')"><span class="emoji">‚öΩ</span> Soccer</button>
                <button class="filter-chip" type="button" onclick="applyFilterChip('')">Clear</button>
            </div>
        </div>

        {% if sections %}
            {% set ns = namespace(live_games=[]) %}
            {% for section in sections %}
                {% for g in section.games %}
                    {% if g.is_live %}
                        {% set ns.live_games = ns.live_games + [g] %}
                    {% endif %}
                {% endfor %}
            {% endfor %}

            {% if ns.live_games %}
                <section class="now-playing">
                    <div class="now-playing-header">
                        <div class="now-playing-title">Now Playing</div>
                        <div class="now-playing-subtitle">
                            Showing up to {{ [ns.live_games|length, 5]|min }} live games
                        </div>
                    </div>
                    <div class="now-playing-list">
                        {% for game in ns.live_games[:5] %}
                            <a href="{{ url_for('game_detail', game_id=game.id) }}" class="now-playing-item">
                                <span class="live-dot"></span>
                                <span class="now-playing-matchup">{{ game.matchup }}</span>
                                <span class="now-playing-meta">
                                    ‚Ä¢ {{ game.sport or 'Sport' }}{% if game.time %} ‚Ä¢ {{ game.time }}{% endif %}
                                </span>
                            </a>
                        {% endfor %}
                    </div>
                </section>
            {% endif %}
        {% endif %}

        {% if sections %}
            {% for section in sections %}
                {% set live_count = section.games|selectattr('is_live')|list|length %}

                <div class="sport-section">
                    <div class="sport-header">
                        <div class="sport-header-left">
                            <div class="sport-pill"></div>
                            <div class="sport-title-text">
                                <h2>{{ section.sport }}</h2>
                                <div class="sport-subtitle">
                                    {{ section.games|length }} game{% if section.games|length != 1 %}s{% endif %}
                                    {% if live_count > 0 %}
                                        ‚Ä¢ <span class="live-dot"></span> {{ live_count }} live
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="sport-toggle-icon">‚ñ∂</div>
                    </div>

                    <div class="sport-body">
                        <div class="sport-games-grid">
                            {% for game in section.games %}
                                <div class="game-card">
                                    <div class="game-title-row">
                                        <div class="game-title">
                                            <a href="{{ url_for('game_detail', game_id=game.id) }}">
                                                {{ game.matchup }}
                                            </a>
                                        </div>
                                        {% if game.is_live %}
                                            <button class="live-button" type="button">LIVE</button>
                                        {% endif %}
                                    </div>

                                    <div class="game-tags-row">
                                        <div class="game-tags">
                                            {% if game.sport %}
                                                <span class="tag-pill">{{ game.sport }}</span>
                                            {% endif %}
                                            {% if game.tournament %}
                                                <span class="tag-pill outline">{{ game.tournament }}</span>
                                            {% endif %}
                                        </div>
                                        <div class="game-time">
                                            {% if game.time %}
                                                {{ game.time }}
                                            {% elif game.time_unix %}
                                                {{ game.time_unix }}
                                            {% else %}
                                                Time TBA
                                            {% endif %}
                                        </div>
                                    </div>

                                    <div class="meta">
                                        <strong>Date:</strong> {{ game.date_header or 'Today' }}<br>
                                        {% if game.tournament_url %}
                                            <a href="{{ game.tournament_url }}" target="_blank">View tournament page ‚Üó</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                No games found{% if search_query %} for "<strong>{{ search_query }}</strong>"{% endif %}.
                Try another team, league, or tournament.
            </div>
        {% endif %}
    </div>

    <!-- Fixed right-side 160x600 ad (does NOT push content down) -->
    <div class="vertical-ad-fixed">
        <script type="text/javascript">
          atOptions = {
          	'key' : '29ef845582924216c628b8930841e3bb',
          	'format' : 'iframe',
          	'height' : 600,
          	'width' : 160,
          	'params' : {}
          };
        </script>
        <script
          type="text/javascript"
          src="https://broodbelongminiature.com/29ef845582924216c628b8930841e3bb/invoke.js"
        ></script>
    </div>

    {% if most_viewed_games %}
        <div class="vertical-most-viewed-fixed">
            <div class="most-viewed-box">
                <div class="most-viewed-header">
                    <span>Most Viewed</span>
                    <span class="badge">{{ most_viewed_games|length }} game{% if most_viewed_games|length != 1 %}s{% endif %}</span>
                </div>
                <div class="most-viewed-list">
                    {% for g in most_viewed_games %}
                        <a href="{{ url_for('game_detail', game_id=g.id) }}" class="mv-item">
                            <div class="mv-title">{{ g.matchup }}</div>
                            <div class="mv-meta">
                                {{ g.sport or 'Sport' }}{% if g.time %} ‚Ä¢ {{ g.time }}{% endif %}
                            </div>
                            <div class="mv-viewers">
                                {{ g.active_viewers }} viewer{% if g.active_viewers != 1 %}s{% endif %}
                            </div>
                        </a>
                    {% endfor %}
                </div>
            </div>
        </div>
    {% endif %}

    <footer>
        <div class="footer-inner">
            <p>Follow TheStreamDen:</p>
            <div class="social-row">
                <a class="social-link" href="https://x.com/thestreamden" target="_blank" rel="noopener">
                    ùïè <span class="handle">@TheStreamDen</span>
                </a>
                <a class="social-link" href="https://x.com/CWILL18MVP" target="_blank" rel="noopener">
                    Main social: <span class="handle">@CWILL18MVP</span>
                </a>
            </div>
        </div>
    </footer>

    <script>
        function toggleLiveOnly(currentlyOn) {
            const url = new URL(window.location.href);
            if (currentlyOn) url.searchParams.delete('live_only');
            else url.searchParams.set('live_only', '1');
            window.location.href = url.toString();
        }

        function applyFilterChip(term) {
            const input = document.getElementById('searchInput');
            if (!input) return;
            input.value = term;
            const form = input.closest('form');
            if (form) form.submit();
        }

        document.addEventListener('DOMContentLoaded', function () {
            const sections = document.querySelectorAll('.sport-section');
            sections.forEach(function (sec, index) {
                const header = sec.querySelector('.sport-header');
                if (!header) return;

                header.addEventListener('click', function () {
                    sec.classList.toggle('open');
                });

                if (index === 0) sec.classList.add('open');
            });
        });
    </script>

    <!-- Cloudflare Web Analytics -->
    <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "643968b4db2b4d4c80a6f49718fcfcaa"}'></script>
    <!-- End Cloudflare Web Analytics -->

    <!-- Adsterra Social Bar (let it position itself, no custom wrapper) -->
    <script
      type="text/javascript"
      src="https://broodbelongminiature.com/0f/a2/4c/0fa24c36bd8ef534a07b2aebe1ba89c3.js"
    ></script>

    <!-- NEW: Adsterra ad unit (added) -->
    <script
      type="text/javascript"
      defer
      src="https://graduatedoutside.com/10/0b/5c/100b5c0f06c917d350ecd499f4f7fa16.js"
    ></script>
</body>
</html>
